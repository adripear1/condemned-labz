{% comment %} This file is auto-generated. Do not edit this file. {% endcomment %}
{% assign tailwind_prefix = block.settings.tailwind_prefix | split: ':' | first %}
{% if tailwind_prefix != blank %}
  {% comment %}
    Matches the tailwind.config.js file
    to ensure that the same configuration is used for the
    Tailwind CSS CDN as the compiler

    Note:
    	Do not use `@import "tailwindcss";`
    This will add the preflight styles to the page and override the existing theme styles
  {% endcomment %}
  <template id='ss-tw-support'>
    <script src='https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4.0.8'></script>
    <style type='text/tailwindcss'>
      {% comment %}
      same as `preflight: false`
      {% endcomment %}
      @layer theme, base, components, utilities;
      @import "tailwindcss/theme" layer(theme);
      @import "tailwindcss/utilities" layer(utilities);

      @import "tailwindcss/utilities" important;
      @import "tailwindcss/utilities" prefix({{ tailwind_prefix }});
      @theme reference prefix({{ tailwind_prefix }});

      @theme {
        --breakpoint-sm: 320px;
        --breakpoint-md: 750px;
        --breakpoint-lg: 1366px;
        --breakpoint-xlg: 1920px;
        --breakpoint-pageMaxWidth: 1366px;
      }
    </style>
  </template>

  <!--
    Dynamically inject Tailwind CDN
    Only imports when the the page has tailwind classes
    and the prefix is set
  -->
  <script>
    function injectTailwindCDN() {
      const hasTailwindCDN = !!document.querySelector('[class*="{{ tailwind_prefix }}:"]');
      if (hasTailwindCDN) {
        // inject alpine cdn into the page
        console.log('Found Tailwind Prefix, injecting tailwind cdn and config');
        const tailwind = document.querySelector('#ss-tw-support')?.content;
        if (tailwind) {
          document.head.appendChild(tailwind);
        }
      }
    }

    injectTailwindCDN();
    ['shopify:section:load'].map((event) => document.addEventListener(event, injectTailwindCDN));
  </script>
{% endif %}

{% schema %}
{
  "name": "Tailwind Support",
  "tag": null,
  "settings": [
    {
      "type": "paragraph",
      "content": "Enables [Tailwind CSS](https://tailwindcss.com/) usage in the theme editor."
    },
    {
      "type": "text",
      "id": "tailwind_prefix",
      "label": "Tailwind Prefix",
      "default": "tw:",
      "info": "Uses Tailwind 4 prefixing syntax (a colon is required at the end of the prefix -- e.g. tw:text-red-500)"
    },
    {
      "type": "paragraph",
      "content": "Cannot be blank. Blank values will disable Tailwind support."
    },
    {
      "type": "header",
      "content": "Performance Note"
    },
    {
      "type": "paragraph",
      "content": "Tailwind is only downloaded when at least one class on the page uses the tailwind prefix, otherwise it will not be downloaded and thus will not impact page load speed."
    }
  ],
  "presets": [
    {
      "name": "Tailwind Support"
    }
  ]
}
{% endschema %}
