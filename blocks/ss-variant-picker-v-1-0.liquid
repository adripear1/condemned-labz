{% comment %} This file is auto-generated. Do not edit this file. {% endcomment %}
{% stylesheet %}
  .ss-variant-block label {
    display: inline-block;
    padding-block: 8px;
  }

  .ss-variant-select {
    position: relative;
  }

  .ss-variant-select svg {
    position: absolute;
    height: 6px;
    top: 50%;
    transform: translateY(-50%);
    right: 1rem;
    pointer-events: none;
  }

  .ss-variant-block select {
    width: 100%;
    padding-block: 12px;
    padding-inline: 10px 30px;
    border-radius: 4px;
    border: 1px solid #000;
    appearance: none;
  }
{% endstylesheet %}

{% javascript %}
  class ProductInputs extends HTMLElement {
    constructor() {
      super();
      this.section = this.closest('.shopify-section');
      this.hiddenVariantInput = this.section.querySelector(`input[name="id"]`);
      this.inputElement = this.querySelector(`[name="id"]`);
      this.addEventListener('change', this.#updateHiddenInput);
    }

    #updateHiddenInput = () => {
      this.hiddenVariantInput.value = this.inputElement.value;
    };
  }

  if (!customElements.get('ss-product-inputs')) {
    customElements.define('ss-product-inputs', ProductInputs);
  }
{% endjavascript %}

{%- liquid
  assign product = block.settings.product
  assign product_form_id = 'product-form-' | append: section.id | append: product.id
-%}

{% capture style_panel_vars %}
  {% render 'ss-style-panel-v-1-0',
    settings: block.settings,
    type: 'size,spacing'
  %}
{% endcapture %}

{%- unless product.has_only_default_variant -%}
  <ss-product-inputs
    id='variant-selects-{{ section.id }}'
    class='
      ss-size-panel
      ss-spacing-panel
      ss-variant-block
      ss-block
    '
    style='{{ style_panel_vars }}'
    data-url='{{ product.url }}'
    data-section='{{ section.id }}{{ product.id }}'
    data-input-name='id'
    {{ block.shopify_attributes }}
  >
    <div
      {% if product.has_only_default_variant %}
        hidden
      {% endif %}
    >
      <label for='Variants-{{ section.id }}'>Options</label>
      <div class='ss-variant-select'>
        <select
          name='id'
          id='Variants-{{ section.id }}'
          form='{{ product_form_id }}'
        >
          {%- for variant in product.variants -%}
            <option
              {% if variant == product.selected_or_first_available_variant %}
                selected='selected'
              {% endif %}
              {% if variant.available == false %}
                disabled
              {% endif %}
              value='{{ variant.id }}'
            >
              {%- liquid
                echo variant.title
                echo variant.price | money | strip_html | prepend: ' - '
                if variant.available == false
                  echo 'Sold out' | prepend: ' - '
                endif
              -%}
            </option>
          {%- endfor -%}
          {%- unless product.variants -%}
            <option>Product variant</option>
          {%- endunless -%}
        </select>
        <svg aria-hidden='true' focusable='false' class='ss-icon ss-icon-caret' viewBox='0 0 10 6'>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor"></path>
        </svg>
      </div>
    </div>
  </ss-product-inputs>
{%- endunless -%}

{% schema %}
{
  "name": "Product (variants) 1-0",
  "tag": null,
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "header",
      "content": "Size - Desktop"
    },
    {
      "type": "text",
      "id": "size_width",
      "label": "Width",
      "default": "auto"
    },
    {
      "type": "text",
      "id": "size_min-width",
      "label": "Min Width",
      "default": "auto"
    },
    {
      "type": "text",
      "id": "size_max-width",
      "label": "Max Width",
      "default": "none"
    },
    {
      "type": "text",
      "id": "size_height",
      "label": "Height",
      "default": "auto"
    },
    {
      "type": "text",
      "id": "size_min-height",
      "label": "Min Height",
      "default": "auto"
    },
    {
      "type": "text",
      "id": "size_max-height",
      "label": "Max Height",
      "default": "none"
    },
    {
      "type": "text",
      "id": "size_flex-grow",
      "label": "Flex Grow",
      "default": "0"
    },
    {
      "type": "text",
      "id": "size_flex-shrink",
      "label": "Flex Shrink",
      "default": "1"
    },
    {
      "type": "text",
      "id": "size_flex-basis",
      "label": "Flex Basis",
      "default": "auto"
    },
    {
      "type": "header",
      "content": "Size - Mobile"
    },
    {
      "type": "paragraph",
      "content": "Leave fields blank to use the desktop value"
    },
    {
      "type": "text",
      "id": "size_width-mobile",
      "label": "Width",
      "default": "100%"
    },
    {
      "type": "text",
      "id": "size_min-width-mobile",
      "label": "Min Width"
    },
    {
      "type": "text",
      "id": "size_max-width-mobile",
      "label": "Max Width"
    },
    {
      "type": "text",
      "id": "size_height-mobile",
      "label": "Height"
    },
    {
      "type": "text",
      "id": "size_min-height-mobile",
      "label": "Min Height"
    },
    {
      "type": "text",
      "id": "size_max-height-mobile",
      "label": "Max Height"
    },
    {
      "type": "text",
      "id": "size_flex-grow-mobile",
      "label": "Flex Grow"
    },
    {
      "type": "text",
      "id": "size_flex-shrink-mobile",
      "label": "Flex Shrink"
    },
    {
      "type": "text",
      "id": "size_flex-basis-mobile",
      "label": "Flex Basis"
    },
    {
      "type": "header",
      "content": "Spacing - Desktop"
    },
    {
      "type": "text",
      "id": "spacing_padding",
      "label": "Padding",
      "default": "0px",
      "info": "Accepts CSS"
    },
    {
      "type": "text",
      "id": "spacing_margin",
      "label": "Margin",
      "default": "0px",
      "info": "Accepts CSS"
    },
    {
      "type": "header",
      "content": "Spacing - Mobile"
    },
    {
      "type": "paragraph",
      "content": "Leave fields blank to use the desktop value"
    },
    {
      "type": "text",
      "id": "spacing_padding-mobile",
      "label": "Padding",
      "info": "Accepts CSS"
    },
    {
      "type": "text",
      "id": "spacing_margin-mobile",
      "label": "Margin",
      "info": "Accepts CSS"
    }
  ],
  "presets": [
    {
      "name": "Product (variants) 1-0",
      "settings": { "product": "{{ closest.product }}" }
    }
  ]
}
{% endschema %}
